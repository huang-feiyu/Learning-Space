1. Use weighted quick-union with path compression.
2. Add another array. Every element in this array stores the biggest i for the connect component.
3. ?